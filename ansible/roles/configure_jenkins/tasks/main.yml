---
# tasks file for configure_jenkins
- name: install python-jenkins
  pip:
   name: python-jenkins
- name: install plugin ansicolor
  jenkins_plugin:
    name: AnsiColor
    url: "{{ url_server }}"
    url_password: password123
    url_username: user5
    state: present

- name: install plugin timestamper
  jenkins_plugin:
    name: timestamper
    url: "{{ url_server }}"
    url_password: password123
    url_username: user5
    state: present

- name: install plugin Pipeline
  jenkins_plugin:
    name: Pipeline
    url: "{{ url_server }}"
    url_password: password123
    url_username: user5
    state: present

- name: make a jenkins test job
  jenkins_job:
    config: "{{ lookup('template', 'templates/test1.xml.j2') }}"
    name: test1
    password: password123
    url: "{{ url_server }}"
    user: user5
- name : start job
  shell:
   cmd: java -jar jenkins-cli.jar -s http://localhost:8080/jenkins -auth user5:password123 build test1
   chdir: "/home/jenkins"
