pipeline {
    agent{
        label 'master'
        }
    options {
        timestamps()
        ansiColor('xterm')

    }
    stages {
        stage('download files from git') {
            steps{
                 git branch: 'dev', url: 'https://github.com/karpovichart/devops.git'
             }
        }
        stage('copy folder to dest') {
            steps{
                 sh 'cp -r /home/jenkins/workspace/main/ansible/  /home/ubuntu/devops/'
             }
        }
        stage('running ansible playbook') {
            steps {
                ansiblePlaybook(
                becomeUser: 'tomcat',
                colorized: true,
                inventory: '/home/jenkins/workspace/ansible/devops/ansible/hosts.ini',
                playbook: '/home/ubuntu/devops/ansible/pb_conf_wp.yml')
            }
        }
    }
}
