pipeline {
    agent{
        label 'master'
        }
    options {
        timestamps()
        ansiColor('xterm')

    }
    stages {
        stage('download files from git') {
            steps{
                 git branch: 'dev', url: 'https://github.com/karpovichart/devops.git'
             }
        }
        stage('copy folder to dest') {
            steps{
                 sh 'cp -r /home/jenkins/workspace/main/ansible/  /home/tomcat/'
             }
        }
        stage('running ansible playbooks') {
            steps {
                ansiblePlaybook(
                becomeUser: 'tomcat',
                colorized: true,
                inventory: '/home/tomcat/hosts.ini',
                playbook: '/home/tomcat/ansible/pb_install_mysql.yml')
            }
             steps {
                ansiblePlaybook(
                becomeUser: 'tomcat',
                colorized: true,
                inventory: '/home/tomcat/hosts.ini',
                playbook: '/home/tomcat/ansible/pb_install_apache.yml ')
             }
              steps {
                ansiblePlaybook(
                becomeUser: 'tomcat',
                colorized: true,
                inventory: '/home/tomcat/hosts.ini',
                playbook: '/home/tomcat/ansible/pb_install_wp.yml')
             }
             steps {
                ansiblePlaybook(
                becomeUser: 'tomcat',
                colorized: true,
                inventory: '/home/tomcat/hosts.ini',
                playbook: '/home/tomcat/ansible/pb_install_nginx.yml')
             }
        }
    }
}
